
    Directory: C:\Github\Azure-Sentinel\Solutions\Google CLoud Platform Firewall Logs

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d----           11/4/2024  7:18 PM                Package

Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : JSONFiles Should Be Valid
Name      : JSONFiles Should Be Valid
Timespan  : 00:00:00.0125234
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Allowed Values Should Actually Be Allowed
Name      : Allowed Values Should Actually Be Allowed
Timespan  : 00:00:00.0154870
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Controls In Outputs Must Exist
Name      : Controls In Outputs Must Exist
Timespan  : 00:00:00.0110321
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : CreateUIDefinition Must Not Have Blanks
Name      : CreateUIDefinition Must Not Have Blanks
Timespan  : 00:00:00.0138775
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : CreateUIDefinition Should Have Schema
Name      : CreateUIDefinition Should Have Schema
Timespan  : 00:00:00.0106346
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Credential Confirmation Should Not Be Hidden
Name      : Credential Confirmation Should Not Be Hidden
Timespan  : 00:00:00.0128650
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Handler Must Be Correct
Name      : Handler Must Be Correct
Timespan  : 00:00:00.0096352
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : HideExisting Must Be Correctly Handled
Name      : HideExisting Must Be Correctly Handled
Timespan  : 00:00:00.0130191
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Location Should Be In Outputs
Name      : Location Should Be In Outputs
Timespan  : 00:00:00.0089591
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Outputs Must Be Present In Template Parameters
Name      : Outputs Must Be Present In Template Parameters
Timespan  : 00:00:00.0095952
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Parameters Without Default Must Exist In CreateUIDefinition
Name      : Parameters Without Default Must Exist In CreateUIDefinition
Timespan  : 00:00:00.0080987
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Password Textboxes Must Be Used For Password Parameters
Name      : Password Textboxes Must Be Used For Password Parameters
Timespan  : 00:00:00.0114370
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : PasswordBoxes Must Have Min Length
Name      : PasswordBoxes Must Have Min Length
Timespan  : 00:00:00.0124044
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Textboxes Are Well Formed
Name      : Textboxes Are Well Formed
Timespan  : 00:00:00.0103796
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Tooltips Should Be Present
Name      : Tooltips Should Be Present
Timespan  : 00:00:00.0111419
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Usernames Should Not Have A Default
Name      : Usernames Should Not Have A Default
Timespan  : 00:00:00.0104778
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Validations Must Have Message
Name      : Validations Must Have Message
Timespan  : 00:00:00.0116524
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : VMSizes Must Match Template
Name      : VMSizes Must Match Template
Timespan  : 00:00:00.0121528
File      : {[Name, createUiDefinition.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\createUiDefinition.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : adminUsername Should Not Be A Literal
Name      : adminUsername Should Not Be A Literal
Timespan  : 00:00:00.0156279
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : apiVersions Should Be Recent In Reference Functions
Name      : apiVersions Should Be Recent In Reference Functions
Timespan  : 00:00:00.0119809
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : {The apiVersion 2023-04-01-preview was not found for the resource type: Microsoft.SecurityInsights}
Passed    : True
Group     : apiVersions Should Be Recent
Name      : apiVersions Should Be Recent
Timespan  : 00:00:00.0165152
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : artifacts parameter
Name      : artifacts parameter
Timespan  : 00:00:00.0114475
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : CommandToExecute Must Use ProtectedSettings For Secrets
Name      : CommandToExecute Must Use ProtectedSettings For Secrets
Timespan  : 00:00:00.0137938
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : DependsOn Best Practices
Name      : DependsOn Best Practices
Timespan  : 00:00:00.0140550
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Deployment Resources Must Not Be Debug
Name      : Deployment Resources Must Not Be Debug
Timespan  : 00:00:00.0124472
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : DeploymentTemplate Must Not Contain Hardcoded Uri
Name      : DeploymentTemplate Must Not Contain Hardcoded Uri
Timespan  : 00:00:00.0130045
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : DeploymentTemplate Schema Is Correct
Name      : DeploymentTemplate Schema Is Correct
Timespan  : 00:00:00.0108158
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Dynamic Variable References Should Not Use Concat
Name      : Dynamic Variable References Should Not Use Concat
Timespan  : 00:00:00.0104494
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {Property: "contentProductId" must use one of the following expressions for an resourceId property:
                        extensionResourceId,resourceId,subscriptionResourceId,tenantResourceId,if,parameters,reference,variables,subscription,guid, Property: "id" must use one of the following expressions for an resourceId property:
                        extensionResourceId,resourceId,subscriptionResourceId,tenantResourceId,if,parameters,reference,variables,subscription,guid}
Warnings  : {}
Output    : {}
AllOutput : {Property: "contentProductId" must use one of the following expressions for an resourceId property:
                        extensionResourceId,resourceId,subscriptionResourceId,tenantResourceId,if,parameters,reference,variables,subscription,guid, Property: "id" must use one of the following expressions for an resourceId property:
                        extensionResourceId,resourceId,subscriptionResourceId,tenantResourceId,if,parameters,reference,variables,subscription,guid}
Passed    : False
Group     : IDs Should Be Derived From ResourceIDs
Name      : IDs Should Be Derived From ResourceIDs
Timespan  : 00:00:00.0132795
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Location Should Not Be Hardcoded
Name      : Location Should Not Be Hardcoded
Timespan  : 00:00:00.0198732
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : ManagedIdentityExtension must not be used
Name      : ManagedIdentityExtension must not be used
Timespan  : 00:00:00.0104305
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Min And Max Value Are Numbers
Name      : Min And Max Value Are Numbers
Timespan  : 00:00:00.0104781
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Outputs Must Not Contain Secrets
Name      : Outputs Must Not Contain Secrets
Timespan  : 00:00:00.0107260
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Parameter Types Should Be Consistent
Name      : Parameter Types Should Be Consistent
Timespan  : 00:00:00.0136742
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Parameters Must Be Referenced
Name      : Parameters Must Be Referenced
Timespan  : 00:00:00.0158633
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Password params must be secure
Name      : Password params must be secure
Timespan  : 00:00:00.0094574
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : providers apiVersions Is Not Permitted
Name      : providers apiVersions Is Not Permitted
Timespan  : 00:00:00.0091704
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : ResourceIds should not contain
Name      : ResourceIds should not contain
Timespan  : 00:00:00.0122581
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Resources Should Have Location
Name      : Resources Should Have Location
Timespan  : 00:00:00.0093811
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Resources Should Not Be Ambiguous
Name      : Resources Should Not Be Ambiguous
Timespan  : 00:00:00.0101669
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Secure Params In Nested Deployments
Name      : Secure Params In Nested Deployments
Timespan  : 00:00:00.0110222
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Secure String Parameters Cannot Have Default
Name      : Secure String Parameters Cannot Have Default
Timespan  : 00:00:00.0101679
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Template Should Not Contain Blanks
Name      : Template Should Not Contain Blanks
Timespan  : 00:00:00.0161234
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : URIs Should Be Properly Constructed
Name      : URIs Should Be Properly Constructed
Timespan  : 00:00:00.0124620
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {Unreferenced variable: _solutionName, Unreferenced variable: workspaceResourceId, Unreferenced variable: dataConnectorTemplateNameConnectorDefinition1, Unreferenced variable: dataConnectorTemplateNameConnections1}
Warnings  : {}
Output    : {}
AllOutput : {Unreferenced variable: _solutionName, Unreferenced variable: workspaceResourceId, Unreferenced variable: dataConnectorTemplateNameConnectorDefinition1, Unreferenced variable: dataConnectorTemplateNameConnections1}
Passed    : False
Group     : Variables Must Be Referenced
Name      : Variables Must Be Referenced
Timespan  : 00:00:00.0186118
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : Virtual Machines Should Not Be Preview
Name      : Virtual Machines Should Not Be Preview
Timespan  : 00:00:00.0131579
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : VM Images Should Use Latest Version
Name      : VM Images Should Use Latest Version
Timespan  : 00:00:00.0108229
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : VM Size Should Be A Parameter
Name      : VM Size Should Be A Parameter
Timespan  : 00:00:00.0115435
File      : {[Name, mainTemplate.json], [Extension, .json], [Text, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\mainTemplate.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : 


Errors    : {}
Warnings  : {}
Output    : {}
AllOutput : 
Passed    : True
Group     : JSONFiles Should Be Valid
Name      : JSONFiles Should Be Valid
Timespan  : 00:00:00.0116857
File      : {[Name, testParameters.json], [Extension, .json], [Text, {
              "location": {
                "type": "string",
                "minLength": 1,
                "defaultValue": "[resourceGroup().location]",
                "metadata": {
                  "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                }
              },
              "workspace-location": {
                "type": "string",
                "defaultValue": "",
                "metadata": {
                  "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                }
              },
              "workspace": {
                "defaultValue": "",
                "type": "string",
                "metadata": {
                  "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                }
              }
            }
            ], [FullPath, C:\Github\Azure-Sentinel\Solutions\Google Cloud Platform Firewall Logs\Package\testParameters.json]…}
TestInput : {[AllImages, System.Object[]], [FolderName, ], [OriginalTemplateText, {
              "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "metadata": {
                "author": "Microsoft - support@microsoft.com",
                "comments": "Solution template for Google CLoud Platform Firewall Logs"
              },
              "parameters": {
                "location": {
                  "type": "string",
                  "minLength": 1,
                  "defaultValue": "[resourceGroup().location]",
                  "metadata": {
                    "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                  }
                },
                "workspace-location": {
                  "type": "string",
                  "defaultValue": "",
                  "metadata": {
                    "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
                  }
                },
                "workspace": {
                  "defaultValue": "",
                  "type": "string",
                  "metadata": {
                    "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                  }
                }
              },
              "variables": {
                "email": "support@microsoft.com",
                "_email": "[variables('email')]",
                "_solutionName": "Google CLoud Platform Firewall Logs",
                "_solutionVersion": "3.0.0",
                "solutionId": "azuresentinel.azure-sentinel-solution-gcpfirewalllogs",
                "_solutionId": "[variables('solutionId')]",
                "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                "dataConnectorCCPVersion": "1.0.0",
                "_dataConnectorContentIdConnectorDefinition1": "GCPFirewallLogsCCPDefinition",
                "dataConnectorTemplateNameConnectorDefinition1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition1')))]",
                "_dataConnectorContentIdConnections1": "GCPFirewallLogsCCPDefinitionConnections",
                "dataConnectorTemplateNameConnections1": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections1')))]",
                "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
              },
              "resources": {
                "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
                "apiVersion": "2023-04-01-preview",
                "location": "[parameters('workspace-location')]",
                "properties": {
                  "version": "3.0.0",
                  "kind": "Solution",
                  "contentSchemaVersion": "3.0.0",
                  "displayName": "Google CLoud Platform Firewall Logs",
                  "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                  "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>The Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
                  "contentKind": "Solution",
                  "contentProductId": "[variables('_solutioncontentProductId')]",
                  "id": "[variables('_solutioncontentProductId')]",
                  "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">",
                  "contentId": "[variables('_solutionId')]",
                  "parentId": "[variables('_solutionId')]",
                  "source": {
                    "kind": "Solution",
                    "name": "Google CLoud Platform Firewall Logs",
                    "sourceId": "[variables('_solutionId')]"
                  },
                  "author": {
                    "name": "Microsoft",
                    "email": "[variables('_email')]"
                  },
                  "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                  },
                  "dependencies": {
                    "operator": "AND",
                    "criteria": [
                      {
                        "kind": "DataConnector",
                        "contentId": "[variables('_dataConnectorContentIdConnections1')]",
                        "version": "[variables('dataConnectorCCPVersion')]"
                      }
                    ]
                  },
                  "firstPublishDate": "2024-11-03",
                  "providers": [
                    "Google"
                  ],
                  "categories": {
                    "domains": [
                      "DevOps",
                      "Security"
                    ]
                  }
                },
                "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
              },
              "outputs": {}
            }
            ], [createUIDefinitionText, {
              "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
              "handler": "Microsoft.Azure.CreateUIDef",
              "version": "0.1.2-preview",
              "parameters": {
                "config": {
                  "isWizard": false,
                  "basics": {
                    "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Solutions/Google%20Cloud%20Platform%20Audit%20Logs/logo/Google-Cloud-Branding.png\" width=\"75px\" height=\"75px\">\n\n**Note:** Please refer to the following before installing the solution: \n\n• Review the solution [Release Notes](https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Google%20CLoud%20Platform%20Firewall%20Logs/ReleaseNotes.md)\n\n • There may be [known issues](https://aka.ms/sentinelsolutionsknownissues) pertaining to this Solution, please refer to them before installing.\n\nThe Google Cloud Platform (GCP) firewall logs, ingested from Sentinel's connector, enable you to capture and track all network activity that occurs in your GCP intances. These firewall logs provide valuable insights for monitoring user activity, troubleshooting issues, and ensuring compliance with security regulations. They serve as a record of events that practitioners can utilize to monitor access and identify potential threats across GCP resources.\n\n\n\n[Learn more about Microsoft Sentinel](https://aka.ms/azuresentinel) | [Learn more about Solutions](https://aka.ms/azuresentinelsolutionsdoc)",
                    "subscription": {
                      "resourceProviders": [
                        "Microsoft.OperationsManagement/solutions",
                        "Microsoft.OperationalInsights/workspaces/providers/alertRules",
                        "Microsoft.Insights/workbooks",
                        "Microsoft.Logic/workflows"
                      ]
                    },
                    "location": {
                      "metadata": {
                        "hidden": "Hiding location, we get it from the log analytics workspace"
                      },
                      "visible": false
                    },
                    "resourceGroup": {
                      "allowExisting": true
                    }
                  }
                },
                "basics": [
                  {
                    "name": "getLAWorkspace",
                    "type": "Microsoft.Solutions.ArmApiControl",
                    "toolTip": "This filters by workspaces that exist in the Resource Group selected",
                    "condition": "[greater(length(resourceGroup().name),0)]",
                    "request": {
                      "method": "GET",
                      "path": "[concat(subscription().id,'/providers/Microsoft.OperationalInsights/workspaces?api-version=2020-08-01')]"
                    }
                  },
                  {
                    "name": "workspace",
                    "type": "Microsoft.Common.DropDown",
                    "label": "Workspace",
                    "placeholder": "Select a workspace",
                    "toolTip": "This dropdown will list only workspace that exists in the Resource Group selected",
                    "constraints": {
                      "allowedValues": "[map(filter(basics('getLAWorkspace').value, (filter) => contains(toLower(filter.id), toLower(resourceGroup().name))), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]",
                      "required": true
                    },
                    "visible": true
                  }
                ],
                "steps": null,
                "outputs": {
                  "workspace-location": "[first(map(filter(basics('getLAWorkspace').value, (filter) => and(contains(toLower(filter.id), toLower(resourceGroup().name)),equals(filter.name,basics('workspace')))), (item) => item.location))]",
                  "location": "[location()]",
                  "workspace": "[basics('workspace')]"
                }
              }
            }
            ]…}
Summary   : @{Fail=2; Pass=47; Total=49}


